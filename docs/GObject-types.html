<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Copyright (C) 2018 Michael L. Gran

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3
or any later version published by the Free Software Foundation;
with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
Texts.  A copy of the license is included in the section entitled "GNU
Free Documentation License". -->
<!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>GObject types (Guile GI)</title>

<meta name="description" content="GObject types (Guile GI)">
<meta name="keywords" content="GObject types (Guile GI)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="_005findex.html#g_t_005findex" rel="index" title="_index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Reference-Guide.html#Reference-Guide" rel="up" title="Reference Guide">
<link href="Further-Resources-and-Contact-Info.html#Further-Resources-and-Contact-Info" rel="next" title="Further Resources and Contact Info">
<link href="typelib-introspection-procedures.html#typelib-introspection-procedures" rel="prev" title="typelib introspection procedures">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>
<link rel="stylesheet" type="text/css" href="document-1.0.1.css">


</head>

<body lang="en">
<a name="GObject-types"></a>
<div class="header">
<p>
Previous: <a href="typelib-introspection-procedures.html#typelib-introspection-procedures" accesskey="p" rel="prev">typelib introspection procedures</a>, Up: <a href="Reference-Guide.html#Reference-Guide" accesskey="u" rel="up">Reference Guide</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="_005findex.html#g_t_005findex" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="GObject-Types"></a>
<h3 class="section">3.2 GObject Types</h3>

<p>If you inspect the bindings generated by <code>load-repository</code>, you
will notice many references to the helper functions
<code>gi-function-invoke</code>, <code>gi-method-prepare</code>, and
<code>gi-method-send</code>.  These procedures convert Guile parameters and
return values to GObject-friendly C parameters and return values.
</p>
<p>If you look at the bindings generated by <code>export-typelib</code>, the
comments and docstrings indicate the types expected by the procedures.
</p>
<p>For integer and string arguments, the C to Guile conversions are the
obvious ones. But for GObject types, things get a bit more complex.
GObject has three classes of custom types: structs, unions, and
objects.
</p>
<p>GObject unions and structs are handled in Guile-GI by storing them in
a <code>&lt;GBox&gt;</code> foreign object type.  <code>&lt;GBox&gt;</code> types are
typically opaque.  The can be created and by GObject functions and
used as arguments, but, their contents aren&rsquo;t otherwise modifyiable.
</p>
<p>GObject objects are stored in a <code>&lt;GObject&gt;</code> foreign object type.
They have slightly more interactivity available at the Guile layer.
They have properties that can be queried and Guile procedures can be
hooked into the GObject callback layer, which GObject calls &ldquo;signals&rdquo;.
</p>
<dl>
<dt><a name="index-gobject_002dtype_002dname"></a>Procedure: <strong>gobject-type-name</strong> <em>obj</em></dt>
<dd><p>Given <var>obj</var>, a GObject, this returns that name of its type as a
string.
</p></dd></dl>

<dl>
<dt><a name="index-gobject_002dget_002dproperty"></a>Procedure: <strong>gobject-get-property</strong> <em>obj prop</em></dt>
<dt><a name="index-gobject_002dset_002dproperty_0021"></a>Procedur: <strong>gobject-set-property!</strong> <em>obj prop val</em></dt>
<dd><p>Given <var>obj</var>, a GObject and  <var>val</var>, a string name of an object property,
these procedures get and set properties of the GObject.
</p></dd></dl>

<dl>
<dt><a name="index-signal_002dconnect"></a>Procedure: <strong>signal-connect</strong> <em>obj signal-name procedure rest</em></dt>
<dd><p>Given <var>obj</var>, a GObject instance, <var>signal-name</var>, <var>procedure</var>,
a procedure to be used as a callback, and <var>rest</var>, this attaches
the callback procedure to the object so that it is called when the
GObject signal is emitted.
</p></dd></dl>

<a name="On-Guile-to-C-Type-Conversions"></a>
<h4 class="subsection">3.2.1 On Guile to C Type Conversions</h4>

<p>Guile-GI uses a rule system to convert Guile procedure arguments to C
types.  Typically these conversions between Guile and C types are
straightforward, but, some conversions are tricky and need additional
description.
</p>
<a name="Strings"></a>
<h4 class="subsubsection">3.2.1.1 Strings</h4>

<p>GObject libraries usually use UTF-8 encoding for their strings, while
Guile uses a different encoding internally for its strings.  Thus
every time a string is parameter is passed through to a C procedure, a
new UTF-8 copy of the Guile string is created.  The string is
automatically freed when no longer in use.
</p>
<p>GObject has some procedures that deal with locale-encoded strings:
notably those procedures that deal with environment variables.
Guile-GI converts Guile strings to locale-encoded strings for those
procedures.  Note that this may throw an encoding error if the Guile
string cannot be represented in the current locale.
</p>
<a name="C-Arrays"></a>
<h4 class="subsection">3.2.2 C Arrays</h4>

<p>There are many different types of C arrays, and the Guile types
expected for GObject procedures that C arrays varies depending on the
type required.
</p>
<p>Typically, for simple C arrays of numerical types &ndash; integers, floating
points, etc &ndash; a Guile bytevector needs to be used.  For these
bytevectors, always use native-endianness.
</p>
<p>For C arrays of GObject objects, structs, unions, flags, enums, and
GTypes, a <em>list</em> is used instead of a bytevector.
</p>
<p>If the C procedure expects a zero-terminated array, Guile-GI will
provide that automatically.  There is no need to add you own zero.
</p>
<p>Some GObject procedures write output information into preallocated C
arrays.  For those procedures, the Guile caller will need to create
and pass in a bytevector of the appropriate size.
</p>
<blockquote>
<p><b>Warning:</b> It is best not to use any of GLib&rsquo;s <code>Array</code> and <code>ByteArray</code>
procedures directly.  Since arrays get converted to bytevectors, these
procedures will likely fail to do anything sensible.
</p></blockquote>

<hr>
<div class="header">
<p>
Previous: <a href="typelib-introspection-procedures.html#typelib-introspection-procedures" accesskey="p" rel="prev">typelib introspection procedures</a>, Up: <a href="Reference-Guide.html#Reference-Guide" accesskey="u" rel="up">Reference Guide</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="_005findex.html#g_t_005findex" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
